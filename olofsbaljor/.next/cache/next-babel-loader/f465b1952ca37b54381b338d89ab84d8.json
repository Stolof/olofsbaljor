{"ast":null,"code":"\"use strict\";\n\nvar _contentful = require(\"contentful\");\n\nconst client = (0, _contentful.createClient)({\n  space: process.env.NEXT_PUBLIC_CONTENTFUL_SPACE_ID,\n  accessToken: process.env.NEXT_PUBLIC_CONTENTFUL_ACCESS_TOKEN\n});\n\nasync function getEntry(id) {\n  const recipe = await client.getEntry(id);\n  return parseForm(recipe);\n}\n\nasync function getAllRecipes() {\n  const recipes = await client.getEntries({\n    'content_type': 'recipe'\n  });\n  return recipes;\n}\n\nfunction parseForm(recipe) {\n  return {\n    recipe: recipe.fields\n  };\n}\n\nasync function getNutrientForAllRecipes(recipes) {\n  let nutrientsPerRecipe = {};\n\n  for (const recipe of recipes) {\n    const ingredients = recipe.fields.ingredients;\n    const recipeNutrients = await getNutrientsForRecipe(ingredients);\n    nutrientsPerRecipe[recipe.fields.title] = recipeNutrients;\n  }\n\n  ;\n  return nutrientsPerRecipe;\n}\n\nasync function getNutrientsForRecipe(ingredients) {\n  let recipeNutrients = {};\n\n  for (const ingredient of ingredients) {\n    const productId = ingredient.fields.id;\n    const productNutrients = await getNutrientsForProduct(productId);\n\n    for (const nutrient of productNutrients) {\n      if (nutrient.name in recipeNutrients) {\n        recipeNutrients[nutrient.name] = nutrient.value + recipeNutrients[nutrient.name];\n      } else {\n        recipeNutrients[nutrient.name] = nutrient.value;\n      }\n    }\n\n    ;\n  }\n\n  return recipeNutrients;\n}\n\nasync function getNutrientsForProduct(productId) {\n  const livsmedelkollenAPI = 'https://api.livsmedelkollen.se/foodstuffs/';\n  const res = await fetch(livsmedelkollenAPI + productId, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n  const nutrients = await res.json();\n  return await nutrients;\n}\n\nmodule.exports = {\n  getEntry: getEntry,\n  getAllRecipes: getAllRecipes,\n  getNutrientForAllRecipes: getNutrientForAllRecipes\n};","map":null,"metadata":{},"sourceType":"script"}